<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Sikad/Tricycle Fare Calculator for Midsayap, Cotabato" />
    <meta name="theme-color" content="#000000" />

    <title>Sikad Fare Calculator - Midsayap</title>

    <link rel="manifest" href="manifest.json" />
    <link rel="icon" type="image/png" href="icon-192.png" />
    <link rel="apple-touch-icon" href="icon-192.png" />
    <link rel="stylesheet" href="style.css" />
    <!-- Leaflet (OpenStreetMap) -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>ðŸš² Sikad Fare Calculator</h1>
            <p>Fare Guide - Midsayap, Cotabato</p>
            <p style="font-size: 12px; margin-top: 5px;">Based on LGU Ordinance No. 536</p>
        </div>

        <div class="content">
            <!-- âœ… PWA Install Prompt -->
            <div id="installPrompt" class="install-prompt" style="display: none;">
                <p>ðŸ“± Install this app for offline use!</p>
                <div class="install-prompt-actions">
                    <button id="installButton" class="btn-install">Install App</button>
                    <button id="dismissButton" class="btn-dismiss">Maybe Later</button>
                </div>
            </div>

            <!-- âœ… Offline Indicator -->
            <div id="offlineIndicator" class="offline-indicator" style="display: none;">
                ðŸ“¡ You're offline - using cached data
            </div>

            <!-- âœ… Mode Switcher -->
            <div class="mode-switcher">
                <button id="routeModeBtn" type="button" class="mode-btn" onclick="setMode('route')">Route</button>
                <button id="mapModeBtn" type="button" class="mode-btn" onclick="setMode('map')">Map</button>
            </div>

            <!-- âœ… Map Mode Card (hidden by default) -->
            <div id="mapCard" class="map-card" style="display: none;">
                <div id="map" style="height: 400px;"></div>
                <div class="map-card-footer">
                    <div style="display:flex; gap:8px; flex-wrap:wrap; align-items:center;">
                        <button id="setOriginBtn" class="btn" type="button" style="margin-top:6px;">Set Origin by Click</button>
                        <button id="resetOriginBtn" class="btn btn-reset" type="button" style="margin-top:6px;">Use My Location</button>
                    </div>
                    <div class="map-results" style="margin-top:12px; text-align:left; color: black;">
                        <p id="mapRateUsed" style="font-size:13px; color:#004ea8;">Rate Used: â‚±- /km</p>
                        <p id="mapRoadEstimate" style="font-size:13px; color:#cc5500;">Estimated road distance: - km</p>
                        <p id="mapWarning" style="font-size:12px; color:#aa0000;">Note: Fare is based on an estimated road distance (straight-line distance + 8%) to account for road curves.</p>
                    </div>
                    <!-- Action Buttons for Map Mode -->
                    <button id="mapCalculateBtn" class="btn" type="button" style="width:100%; margin-top:16px;">Calculate Fare</button>
                    <button id="resetMapBtn" class="btn btn-reset" type="button" style="width:100%; margin-top:8px;">Reset</button>
                </div>
            </div>

            <!-- âœ… Origin Selector -->
            <div class="form-group" id="originContainer">
                <label for="origin">Origin (From)</label>
                <select id="origin" onchange="updateDestinations()">
                    <option value="">-- Select Origin --</option>

                    <optgroup label="Within Midsayap Proper">
                        <option value="Pob 1">Poblacion 1</option>
                        <option value="Pob 2">Poblacion 2</option>
                        <option value="Pob 3">Poblacion 3</option>
                        <option value="Pob 4">Poblacion 4</option>
                        <option value="Pob 5">Poblacion 5</option>
                        <option value="Pob 6">Poblacion 6</option>
                        <option value="Pob 7">Poblacion 7</option>
                        <option value="Pob 8">Poblacion 8</option>
                        <option value="Public Market">Public Market</option>
                        <option value="Town Hall">Town Hall / Municipal Hall</option>
                    </optgroup>

                    <optgroup label="Outside Midsayap Proper">
                        <option value="Agriculture">Agriculture</option>
                        <option value="Aleosan">Aleosan</option>
                        <option value="Anonang">Anonang</option>
                        <option value="Arizona">Arizona</option>
                        <option value="Bagumba">Bagumba</option>
                        <option value="Baliki">Baliki</option>
                        <option value="Barongis">Barongis</option>
                        <option value="Damatug">Damatug</option>
                        <option value="Kimagango">Kimagango</option>
                        <option value="Kiwanan">Kiwanan</option>
                        <option value="Libungan Proper">Libungan Proper</option>
                        <option value="Palongoguen">Palongoguen</option>
                        <option value="Rangaban">Rangaban</option>
                        <option value="Sadaan">Sadaan</option>
                        <option value="Salunayan">Salunayan</option>
                        <option value="San Isidro">San Isidro</option>
                        <option value="Villarica">Villarica</option>
                    </optgroup>
                </select>
            </div>

            <!-- âœ… Destination Selector -->
            <div class="form-group" id="destinationContainer">
                <label for="destination">Destination (To)</label>
                <select id="destination">
                    <option value="">-- Select Destination --</option>

                    <optgroup label="Within Midsayap Proper">
                        <option value="Pob 1">Poblacion 1</option>
                        <option value="Pob 2">Poblacion 2</option>
                        <option value="Pob 3">Poblacion 3</option>
                        <option value="Pob 4">Poblacion 4</option>
                        <option value="Pob 5">Poblacion 5</option>
                        <option value="Pob 6">Poblacion 6</option>
                        <option value="Pob 7">Poblacion 7</option>
                        <option value="Pob 8">Poblacion 8</option>
                        <option value="Public Market">Public Market</option>
                        <option value="Town Hall">Town Hall / Municipal Hall</option>
                    </optgroup>

                    <optgroup label="Outside Midsayap Proper">
                        <option value="Agriculture">Agriculture</option>
                        <option value="Aleosan">Aleosan</option>
                        <option value="Anonang">Anonang</option>
                        <option value="Arizona">Arizona</option>
                        <option value="Bagumba">Bagumba</option>
                        <option value="Baliki">Baliki</option>
                        <option value="Barongis">Barongis</option>
                        <option value="Damatug">Damatug</option>
                        <option value="Kimagango">Kimagango</option>
                        <option value="Kiwanan">Kiwanan</option>
                        <option value="Libungan Proper">Libungan Proper</option>
                        <option value="Palongoguen">Palongoguen</option>
                        <option value="Rangaban">Rangaban</option>
                        <option value="Sadaan">Sadaan</option>
                        <option value="Salunayan">Salunayan</option>
                        <option value="San Isidro">San Isidro</option>
                        <option value="Villarica">Villarica</option>
                    </optgroup>
                </select>
            </div>

            <!-- âœ… Gas Price Range Selector -->
            <div class="form-group">
                <label for="gasPrice" style="padding-top: 20px ;">Current Gas Price (â‚± per liter)</label>
                <div class="gas-price-display">
                    <span id="currentGasPrice" style="color:black">â‚±51â€“60</span>
                    <button id="changePriceBtn" class="btn-change">Change</button>
                </div>

                <select id="gasPrice" style="display: none;">
                    <option value="40">â‚±30â€“40</option>
                    <option value="50">â‚±41â€“50</option>
                    <option value="60" selected>â‚±51â€“60</option>
                    <option value="70">â‚±61â€“70</option>
                    <option value="80">â‚±71â€“80</option>
                    <option value="90">â‚±81â€“90</option>
                    <option value="100">â‚±91â€“100</option>
                    <option value="110">â‚±101â€“110</option>
                </select>

                <p class="helper-text">
                    Select the current price range at the most expensive gas station.
                </p>
            </div>

            <!-- âœ… Passenger Type -->
            <div class="form-group">
                <label>Passenger Type</label>
                <div class="passenger-type">
                    <div class="radio-option">
                        <input type="radio" id="student" name="passengerType" value="student" checked />
                        <label for="student">Student / PWD / Senior</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" id="regular" name="passengerType" value="regular" />
                        <label for="regular">Regular</label>
                    </div>
                </div>
            </div>

            <!-- âœ… Baggage Checkbox -->
            <div class="form-group">
                <label class="checkbox-label">
                    <input type="checkbox" id="hasBaggage" />
                    <span>Add Baggage Fee (â‚±10.00)</span>
                </label>
            </div>
            <!-- Calculate Fare button is now grouped with the above options -->
            <button id="calculateFareBtn" class="btn" onclick="calculateFare()" style="margin-top: 24px;">Calculate Fare</button>
            <button id="resetFormBtn" class="btn btn-reset" onclick="resetForm()">Reset</button>




            <!-- âœ… Error Message -->
            <div id="error" class="error"></div>

            <!-- âœ… Fare Result Display -->
            <div id="result" class="result">
                <h2>Your Fare</h2>
                <div class="fare-amount">â‚±<span id="fareAmount">0.00</span></div>
                <div class="route-details">
                    <p><strong>Route:</strong> <span id="routeInfo">-</span></p>
                    <p><strong>Distance:</strong> <span id="distanceInfo">-</span> km</p>
                    <p><strong>Passenger Type:</strong> <span id="passengerInfo">-</span></p>
                    <p><strong>Gas Price:</strong> â‚±<span id="gasPriceInfo">-</span>/L</p>
                    <p id="baggageInfo" style="display: none;"><strong>Baggage Fee:</strong> â‚±10.00</p>
                    <p id="regularFareLine" style="display: none;"><strong>Regular Fare:</strong> â‚±<span id="regularFareInfo">-</span></p>
                    <p id="studentFareLine" style="display: none;"><strong>Student/Senior/PWD Fare:</strong> â‚±<span id="studentFareInfo">-</span></p>
                    <p id="rateUsedLine" style="display: none;"><strong>Rate Used:</strong> â‚±<span id="rateUsedInfo">-</span>/km</p>
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
